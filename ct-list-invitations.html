<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-input/paper-input.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../paper-item/paper-item.html">
<link rel="import" href="../paper-dialog/paper-dialog.html">

<link rel="import" href="../paper-listbox/paper-listbox.html">

<!--
`ct-list-invitations`
Element to display a list of invitations received by a user on the Centular platform

@demo demo/index.html
-->

<dom-module id="ct-list-invitations">
  <template>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <style is="custom-style">
      :host {

        display: block;

        --paper-input-container:  {
          border-top:1px solid #ccc;
          border-left:1px solid #ccc;
          border-right:1px solid #ccc;
          border-bottom: none;
          padding: 0;
          /*  margin-bottom: 24px; */
        };

        /*padding to move from border */


        --paper-input-container-label: {
          margin-left: 10px;
        };
        --paper-input-container-label-floating: {
          margin-left: 10px;
        };


        --paper-input-error: {
          left: auto !important;
          right: 20px !important;
          font-style: italic;
        };

        /*--paper-icon-button-ink-color: var(--breadcrumb-icon-color-ripple);*/
      }

      .main-section {
        margin-top:20px;
      }


      iron-icon.user-online{
        --iron-icon-fill-color:{#4d96bb;};

      }
      /*local dropdown menu */
      paper-menu {
        width: 400px;
      }
      paper-dropdown-menu.custom-dropdown {
        width: 100%;
        --paper-input-container: {
          border-top:1px solid #ccc;
          border-left:1px solid #ccc;
          border-right:1px solid #ccc;
          border-bottom: none;
          padding: 0;
          margin-bottom: 8px;
        };
        --paper-input-container-input: {
          padding-left: 10px;
        };
      }

    </style>

    <div class="main-section">
      <div class="container-fluid">

        <div class="row">
          <div class="col-xs-12">
            <div class="table-responsive">
              <table class="table table-striped table-bordered table-hover table-middle">
                <thead>
                <th>Application</th>
                <th>Invited By</th>
                <th>Groups</th>
                <th>Actions</th>
                </thead>
                <tbody>

                <template is="dom-repeat" items="{{invitationList}}">
                  <tr>
                    <td>[[item.appName]]</td>
                    <td><span>[[item.invitedBy.firstName]]</span> <span>[[item.invitedBy.lastName]]</span></td>
                    <td>[[item.groupName]]</td>
                    <td class="text-center">
                      <paper-button class="table-button btn-default btn-sm" on-tap="_openDeclineModal" raised>Decline</paper-button>
                      <paper-button class="table-button btn-primary btn-sm" on-tap="_acceptInvitation" raised>Accept</paper-button>
                    </td>
                  </tr>
                </template>

                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <paper-dialog
            id="declineModal"
            modal
            on-iron-overlay-opened="_patchOverlay">
      <h2>Decline Invitation</h2>
      <p>Are you sure you want to decline this invitation?</p>
      <div class="buttons">
        <paper-button class="btn btn-link" dialog-dismiss>Cancel</paper-button>
        <paper-button class="btn btn-primary" on-tap="_declineInvitation" autofocus raised>Yes, I want to decline</paper-button>
      </div>
    </paper-dialog>

  </template>

  <script>
      Polymer({

          is: 'ct-list-invitations',

          properties: {
              invitationList: Array,
              tempDeclineId: String
          },

          _viewSingleStaff : function(e) {

              if(e.model && e.model.item.id){
                  this.fire('viewStaff', id);
              } else {
                  console.log('error');
                  this.fire('toast', {message: 'Cannot display staff member', type: 'danger'});
              }

          },

          _declineInvitation : function(e){
              this.fire('declineInvite', this.tempDeclineId);
          },

          _acceptInvitation : function(e){
              this.fire('acceptInvite', e.model.item.id);
          },

          _openDeclineModal : function(e){
              this.tempDeclineId = e.model.item.id;
              this.$.declineModal.open();
          },

          _patchOverlay: function (e) {
              if (e.target.withBackdrop) {
                  e.target.parentNode.insertBefore(e.target.backdropElement, e.target);
              }
          },

      });
  </script>
</dom-module>
